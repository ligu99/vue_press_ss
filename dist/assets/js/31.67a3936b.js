(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{324:function(e,t,a){"use strict";a.r(t);var s=a(5),n=Object(s.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("p",[t("strong",[e._v("导出表格功能")])]),e._v(" "),t("h5",{attrs:{id:"依赖包安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#依赖包安装"}},[e._v("#")]),e._v(" 依赖包安装")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("npm install -S file-saver xlsx\nnpm install -D script-loader\n")])])]),t("p",[e._v("下载 Blob.js 和 export2Excel.js，放到同一个文件夹\n修改 export2Excel.js,否则第一次点击导出时会报错")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("require('script-loader!file-saver');\nrequire('./Blob');\nrequire('script-loader!xlsx/dist/xlsx.core.min');\n")])])]),t("h5",{attrs:{id:"获取数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#获取数据"}},[e._v("#")]),e._v(" 获取数据")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("exportData() {\n    let param={\n        id :123123\n    }\n    this.$axios.get('/api/test').then( res =>{\n        console.log(res)\n        this.exportList=res.returnObj;\n        this.handleDownload();\n    }).catch(err =>{\n        console.log(err)\n    })\n},\n")])])]),t("h5",{attrs:{id:"导出"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#导出"}},[e._v("#")]),e._v(" 导出")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("handleDownload() {\n    console.log(666)\n    require.ensure([], () => {　　　　　　　　\n        const { export_json_to_excel } = require('@/utils/export2Excel');　　//引入文件　　　　　　\n        const tHeader = ['名称', '邮箱','类型']; //将对应的属性名转换成中文\n        const filterVal = ['Company', 'Email','Type'];//table表格中对应的属性名　　　　　 　　　\n        const list = this.exportList.map(item=>{\n            if(item.Type==='1'){\n                item.Type=\"A类\"\n            }else if(item.Type==='2'){\n                item.Type=\"B类\"\n            }else if(item.Type==='0'){\n                item.Type=\"C类\"\n            }\n            return item;\n        });\n        console.log(list);　　　　　　　\n        const data = this.formatJson(filterVal, list);　　　　　　　　\n        export_json_to_excel(tHeader, data, '列表');　　　　　　\n    })\n},\n\nformatJson(filterVal, jsonData) {\n    return jsonData.map(v => filterVal.map(j => v[j]))\n}\n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);